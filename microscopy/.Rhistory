}
}
}else if(rownames(all_mat)[ii] == "seedling"){
for(ss in 1:2){
all_mat[ii,ss] <- ling_mat[(ii - 283),ss]
}
for(pp in 3:21){
if(colnames(all_mat)[pp] %in% colnames(ling_mat)){
all_mat[ii,pp] <- as.numeric(ling_mat[(ii - 283), colnames(all_mat)[pp]])
}else{
all_mat[ii,pp] <- 0
}
}
}
}
all <- as.data.frame(all_mat, stringsAsFactors = F)
allord <- all[ ,-c(1:2)]
allord$X1 <- as.numeric(allord$X1)
allord$X2 <- as.numeric(allord$X2)
allord$X3 <- as.numeric(allord$X3)
allord$X4 <- as.numeric(allord$X4)
allord$X5 <- as.numeric(allord$X5)
allord$X6 <- as.numeric(allord$X6)
allord$X7 <- as.numeric(allord$X7)
allord$X8 <- as.numeric(allord$X8)
allord$X9 <- as.numeric(allord$X9)
allord$X10 <- as.numeric(allord$X10)
allord$X11 <- as.numeric(allord$X11)
allord$X12 <- as.numeric(allord$X12)
allord$X13 <- as.numeric(allord$X13)
allord$X14 <- as.numeric(allord$X14)
allord$X15 <- as.numeric(allord$X15)
allord$X16 <- as.numeric(allord$X16)
allord$X17 <- as.numeric(allord$X17)
allord$X18 <- as.numeric(allord$X18)
allord$X19 <- as.numeric(allord$X19)
#rownames(allord) <- c(1:308)
alldata <- all[ , 1:2]
perm_all <- adonis(allord ~ Type * Site, data = alldata)
perm_all
NMDSall <- metaMDS(wisconsin(allord), try = 20, trymax = 100, k=2)
NMDS_scores_all <- scores(NMDSall)
NMDS1_all <- NMDS_scores_all[ ,1]
NMDS2_all <- NMDS_scores_all[ ,2]
NMDS_scores_all <- as.data.frame(NMDS_scores_all)
clrs <- c(CC = "black", SAN = "blue", TC = "red")
pchs <- c(CC = 21, SAN = 23, TC = 24)
bgs <- c(Seed = "black", Seedling = "white")
quartz.options(height=5, width=5)
plot.new()
par(oma = c(1, 1, 1, 1))
par(mar = c( 5, 5, 0, 0 ))
plot.window(xlim = c(min(NMDS1_all)-1,max(NMDS1_all)+1), ylim = c(min(NMDS2_all)-1,max(NMDS2_all)+1))
axis(side = 1)
axis(side = 2, las = 1)
points(x = NMDS1_all, y = NMDS2_all, pch = pchs[as.character(alldata$Site)],
col = alpha("black", alpha = 0.5), bg = alpha(bgs[as.character(alldata$Type)], alpha = 0.5), cex = 1)
mtext(side = 1, line = 2, text = "NMDS1")
mtext(side = 2, line = 3, text = "NMDS2" )
#ordiellipse(NMDSling, lingdata$Site == "CC", show.groups = TRUE, kind = "sd", col = "black", lty = 1, lwd = 2.0)
#ordiellipse(NMDSling, lingdata$Site == "TC", show.groups = TRUE, kind = "sd", col = "red", lty = 1, lwd = 2.0)
legend_text <- c("CC", "SAN", "TC")
legend("bottomleft", title= "Sites Sampled", legend_text, pch = c(21,23,24),col = "black", bty = "n", cex = 0.8)
legend_text2 <- c("Seed", "Seedling")
legend("topleft", title= "Sample Type", legend_text2, pch = 22 ,col = "black", pt.bg = alpha(c("black", "white"), alpha = 0.5), bty = "n", cex = 0.8)
box()
NMDSall <- metaMDS(wisconsin(allord), try = 20, trymax = 100, k=2)
NMDS_scores_all <- scores(NMDSall)
NMDS1_all <- NMDS_scores_all[ ,1]
NMDS2_all <- NMDS_scores_all[ ,2]
NMDS_scores_all <- as.data.frame(NMDS_scores_all)
clrs <- c(CC = "black", SAN = "blue", TC = "red")
pchs <- c(CC = 21, SAN = 23, TC = 24)
bgs <- c(Seed = "black", Seedling = "white")
quartz.options(height=5, width=5)
plot.new()
par(oma = c(1, 1, 1, 1))
par(mar = c( 5, 5, 0, 0 ))
plot.window(xlim = c(min(NMDS1_all)-1,max(NMDS1_all)+1), ylim = c(min(NMDS2_all)-1,max(NMDS2_all)+1))
axis(side = 1)
axis(side = 2, las = 1)
points(x = NMDS1_all, y = NMDS2_all, pch = pchs[as.character(alldata$Site)],
col = alpha("black", alpha = 0.5), bg = alpha(bgs[as.character(alldata$Type)], alpha = 0.5), cex = 1)
mtext(side = 1, line = 2, text = "NMDS1")
mtext(side = 2, line = 3, text = "NMDS2" )
#ordiellipse(NMDSling, lingdata$Site == "CC", show.groups = TRUE, kind = "sd", col = "black", lty = 1, lwd = 2.0)
#ordiellipse(NMDSling, lingdata$Site == "TC", show.groups = TRUE, kind = "sd", col = "red", lty = 1, lwd = 2.0)
legend_text <- c("CC", "SAN", "TC")
legend("bottomleft", title= "Sites Sampled", legend_text, pch = c(21,23,24),col = "black", bty = "n", cex = 0.8)
legend_text2 <- c("Seed", "Seedling")
legend("topleft", title= "Sample Type", legend_text2, pch = 22 ,col = "black", pt.bg = alpha(c("black", "white"), alpha = 0.5), bty = "n", cex = 0.8)
box()
clrs <- c(CC = "black", SAN = "blue", TC = "red")
pchs <- c(CC = 21, SAN = 23, TC = 24)
bgs <- c(Seed = "black", Seedling = "white")
quartz.options(height=5, width=5)
plot.new()
par(oma = c(1, 1, 1, 1))
par(mar = c( 5, 5, 0, 0 ))
plot.window(xlim = c(min(NMDS1_all)-3,max(NMDS1_all)+1), ylim = c(min(NMDS2_all)-1,max(NMDS2_all)+1))
axis(side = 1)
axis(side = 2, las = 1)
points(x = NMDS1_all, y = NMDS2_all, pch = pchs[as.character(alldata$Site)],
col = alpha("black", alpha = 0.5), bg = alpha(bgs[as.character(alldata$Type)], alpha = 0.5), cex = 1)
mtext(side = 1, line = 2, text = "NMDS1")
mtext(side = 2, line = 3, text = "NMDS2" )
#ordiellipse(NMDSling, lingdata$Site == "CC", show.groups = TRUE, kind = "sd", col = "black", lty = 1, lwd = 2.0)
#ordiellipse(NMDSling, lingdata$Site == "TC", show.groups = TRUE, kind = "sd", col = "red", lty = 1, lwd = 2.0)
legend_text <- c("CC", "SAN", "TC")
legend("bottomleft", title= "Sites Sampled", legend_text, pch = c(21,23,24),col = "black", bty = "n", cex = 0.8)
legend_text2 <- c("Seed", "Seedling")
legend("topleft", title= "Sample Type", legend_text2, pch = 22 ,col = "black", pt.bg = alpha(c("black", "white"), alpha = 0.5), bty = "n", cex = 0.8)
box()
set.seed(12261984)
NMDSall <- metaMDS(wisconsin(allord), try = 20, trymax = 100, k=2)
NMDS_scores_all <- scores(NMDSall)
NMDS1_all <- NMDS_scores_all[ ,1]
NMDS2_all <- NMDS_scores_all[ ,2]
NMDS_scores_all <- as.data.frame(NMDS_scores_all)
clrs <- c(CC = "black", SAN = "blue", TC = "red")
pchs <- c(CC = 21, SAN = 23, TC = 24)
bgs <- c(Seed = "black", Seedling = "white")
quartz.options(height=5, width=5)
plot.new()
par(oma = c(1, 1, 1, 1))
par(mar = c( 5, 5, 0, 0 ))
plot.window(xlim = c(min(NMDS1_all)-3,max(NMDS1_all)+1), ylim = c(min(NMDS2_all)-1,max(NMDS2_all)+1))
axis(side = 1)
axis(side = 2, las = 1)
points(x = NMDS1_all, y = NMDS2_all, pch = pchs[as.character(alldata$Site)],
col = alpha("black", alpha = 0.5), bg = alpha(bgs[as.character(alldata$Type)], alpha = 0.5), cex = 1)
mtext(side = 1, line = 2, text = "NMDS1")
mtext(side = 2, line = 3, text = "NMDS2" )
#ordiellipse(NMDSling, lingdata$Site == "CC", show.groups = TRUE, kind = "sd", col = "black", lty = 1, lwd = 2.0)
#ordiellipse(NMDSling, lingdata$Site == "TC", show.groups = TRUE, kind = "sd", col = "red", lty = 1, lwd = 2.0)
legend_text <- c("CC", "SAN", "TC")
legend("bottomleft", title= "Sites Sampled", legend_text, pch = c(21,23,24),col = "black", bty = "n", cex = 0.8)
legend_text2 <- c("Seed", "Seedling")
legend("topleft", title= "Sample Type", legend_text2, pch = 22 ,col = "black", pt.bg = alpha(c("black", "white"), alpha = 0.5), bty = "n", cex = 0.8)
box()
set.seed(12261984)
NMDSall <- metaMDS(wisconsin(allord), try = 20, trymax = 50, k=2)
NMDS_scores_all <- scores(NMDSall)
NMDS1_all <- NMDS_scores_all[ ,1]
NMDS2_all <- NMDS_scores_all[ ,2]
NMDS_scores_all <- as.data.frame(NMDS_scores_all)
clrs <- c(CC = "black", SAN = "blue", TC = "red")
pchs <- c(CC = 21, SAN = 23, TC = 24)
bgs <- c(Seed = "black", Seedling = "white")
quartz.options(height=5, width=5)
plot.new()
par(oma = c(1, 1, 1, 1))
par(mar = c( 5, 5, 0, 0 ))
plot.window(xlim = c(min(NMDS1_all)-3,max(NMDS1_all)+1), ylim = c(min(NMDS2_all)-1,max(NMDS2_all)+1))
axis(side = 1)
axis(side = 2, las = 1)
points(x = NMDS1_all, y = NMDS2_all, pch = pchs[as.character(alldata$Site)],
col = alpha("black", alpha = 0.5), bg = alpha(bgs[as.character(alldata$Type)], alpha = 0.5), cex = 1)
mtext(side = 1, line = 2, text = "NMDS1")
mtext(side = 2, line = 3, text = "NMDS2" )
#ordiellipse(NMDSling, lingdata$Site == "CC", show.groups = TRUE, kind = "sd", col = "black", lty = 1, lwd = 2.0)
#ordiellipse(NMDSling, lingdata$Site == "TC", show.groups = TRUE, kind = "sd", col = "red", lty = 1, lwd = 2.0)
legend_text <- c("CC", "SAN", "TC")
legend("bottomleft", title= "Sites Sampled", legend_text, pch = c(21,23,24),col = "black", bty = "n", cex = 0.8)
legend_text2 <- c("Seed", "Seedling")
legend("topleft", title= "Sample Type", legend_text2, pch = 22 ,col = "black", pt.bg = alpha(c("black", "white"), alpha = 0.5), bty = "n", cex = 0.8)
box()
set.seed(19841226)
NMDSall <- metaMDS(wisconsin(allord), try = 20, trymax = 50, k=2)
NMDS_scores_all <- scores(NMDSall)
NMDS1_all <- NMDS_scores_all[ ,1]
NMDS2_all <- NMDS_scores_all[ ,2]
NMDS_scores_all <- as.data.frame(NMDS_scores_all)
clrs <- c(CC = "black", SAN = "blue", TC = "red")
pchs <- c(CC = 21, SAN = 23, TC = 24)
bgs <- c(Seed = "black", Seedling = "white")
quartz.options(height=5, width=5)
plot.new()
par(oma = c(1, 1, 1, 1))
par(mar = c( 5, 5, 0, 0 ))
plot.window(xlim = c(min(NMDS1_all)-3,max(NMDS1_all)+1), ylim = c(min(NMDS2_all)-1,max(NMDS2_all)+1))
axis(side = 1)
axis(side = 2, las = 1)
points(x = NMDS1_all, y = NMDS2_all, pch = pchs[as.character(alldata$Site)],
col = alpha("black", alpha = 0.5), bg = alpha(bgs[as.character(alldata$Type)], alpha = 0.5), cex = 1)
mtext(side = 1, line = 2, text = "NMDS1")
mtext(side = 2, line = 3, text = "NMDS2" )
#ordiellipse(NMDSling, lingdata$Site == "CC", show.groups = TRUE, kind = "sd", col = "black", lty = 1, lwd = 2.0)
#ordiellipse(NMDSling, lingdata$Site == "TC", show.groups = TRUE, kind = "sd", col = "red", lty = 1, lwd = 2.0)
legend_text <- c("CC", "SAN", "TC")
legend("bottomleft", title= "Sites Sampled", legend_text, pch = c(21,23,24),col = "black", bty = "n", cex = 0.8)
legend_text2 <- c("Seed", "Seedling")
legend("topleft", title= "Sample Type", legend_text2, pch = 22 ,col = "black", pt.bg = alpha(c("black", "white"), alpha = 0.5), bty = "n", cex = 0.8)
box()
summary(NMDS_all)
summary(NMDSall)
NMDSall$stress
set.seed(19841226)
NMDS <- metaMDS(wisconsin(seedord), try = 20, trymax = 100, k=2)
set.seed(19841226)
NMDS <- metaMDS(wisconsin(seedord), try = 20, trymax = 50, k=2)
NMDS_scores <- scores(NMDS)
NMDS1 <- NMDS_scores[ ,1]
NMDS2 <- NMDS_scores[ ,2]
NMDS_scores <- as.data.frame(NMDS_scores)
clrs <- c(CC = "black", SAN = "blue", TC = "red")
pchs <- c(CC = 15, SAN = 16, TC = 17)
quartz.options(height=5, width=5)
plot.new()
par(oma = c(1, 1, 1, 1))
par(mar = c( 5, 5, 0, 0 ))
plot.window(xlim = c(min(NMDS1)-1,max(NMDS1)+1), ylim = c(min(NMDS2)-1,max(NMDS2)+1))
axis(side = 1)
axis(side = 2, las = 1)
points(x = NMDS_scores$NMDS1, y = NMDS_scores$NMDS2, pch = pchs[as.character(seeddata$Site)],
col = clrs[as.character(seeddata$Site)], cex = 1)
mtext(side = 1, line = 2, text = "NMDS1")
mtext(side = 2, line = 3, text = "NMDS2" )
ordiellipse(NMDS, seeddata$Site == "CC", show.groups = TRUE, kind = "sd", col = "black", lty = 1, lwd = 2.0)
ordiellipse(NMDS, seeddata$Site == "SAN", show.groups = TRUE, kind = "sd", col = "blue", lty = 1, lwd = 2.0)
ordiellipse(NMDS, seeddata$Site == "TC", show.groups = TRUE, kind = "sd", col = "red", lty = 1, lwd = 2.0)
# ordiellipse(NMDS, metadata$Site == "CM", show.groups = TRUE, kind = "sd", col = "coral", lty = 1, lwd = 2.0)
# ordiellipse(NMDS, metadata$Site == "CR", show.groups = TRUE, kind = "sd", col = "black", lty = 1, lwd = 2.0)
# ordiellipse(NMDS, metadata$Site == "Rt2", show.groups = TRUE, kind = "sd", col = "gray", lty = 1, lwd = 2.0)
legend_text <- c("CC", "SAN", "TC")
legend("bottomright", title= "Sites Sampled", legend_text, pch = c(15,16,17), col = c("black", "blue", "red"), cex = 0.8)
box()
set.seed(19841226)
NMDSling <- metaMDS(wisconsin(lingord_nosan), try = 20, trymax = 50, k=2)
NMDS_scores_ling <- scores(NMDSling)
NMDS1_ling <- NMDS_scores_ling[ ,1]
NMDS2_ling <- NMDS_scores_ling[ ,2]
NMDS_scores_ling <- as.data.frame(NMDS_scores_ling)
clrs <- c(CC = "black", TC = "red")
pchs <- c(CC = 15, TC = 17)
quartz.options(height=5, width=5)
plot.new()
par(oma = c(1, 1, 1, 1))
par(mar = c( 5, 5, 0, 0 ))
plot.window(xlim = c(min(NMDS1_ling)-1,max(NMDS1_ling)+1), ylim = c(min(NMDS2_ling)-1,max(NMDS2_ling)+1))
axis(side = 1)
axis(side = 2, las = 1)
points(x = NMDS_scores_ling$NMDS1, y = NMDS_scores_ling$NMDS2, pch = pchs[as.character(lingdata$Site)],
col = clrs[as.character(lingdata$Site)], cex = 1)
mtext(side = 1, line = 2, text = "NMDS1")
mtext(side = 2, line = 3, text = "NMDS2" )
#ordiellipse(NMDSling, lingdata$Site == "CC", show.groups = TRUE, kind = "sd", col = "black", lty = 1, lwd = 2.0)
#ordiellipse(NMDSling, lingdata$Site == "TC", show.groups = TRUE, kind = "sd", col = "red", lty = 1, lwd = 2.0)
legend_text <- c("CC", "TC")
legend("topleft", title= "Sites Sampled", legend_text, pch = c(15,17),
col = c("black","red"))
box()
clrs <- c(CC = "black", TC = "red")
pchs <- c(CC = 15, TC = 17)
quartz.options(height=5, width=5)
plot.new()
par(oma = c(1, 1, 1, 1))
par(mar = c( 5, 5, 0, 0 ))
plot.window(xlim = c(min(NMDS1_ling)-1,max(NMDS1_ling)+1), ylim = c(min(NMDS2_ling)-1,max(NMDS2_ling)+1))
axis(side = 1)
axis(side = 2, las = 1)
points(x = NMDS_scores_ling$NMDS1, y = NMDS_scores_ling$NMDS2, pch = pchs[as.character(lingdata$Site)],
col = clrs[as.character(lingdata$Site)], cex = 1)
mtext(side = 1, line = 2, text = "NMDS1")
mtext(side = 2, line = 3, text = "NMDS2" )
#ordiellipse(NMDSling, lingdata$Site == "CC", show.groups = TRUE, kind = "sd", col = "black", lty = 1, lwd = 2.0)
#ordiellipse(NMDSling, lingdata$Site == "TC", show.groups = TRUE, kind = "sd", col = "red", lty = 1, lwd = 2.0)
legend_text <- c("CC", "TC")
legend("bottomright", title= "Sites Sampled", legend_text, pch = c(15,17),
col = c("black","red"))
box()
CC<-read.table("~/Documents/Research/R files/CC.txt",header=T)
SAN<-read.table("~/Documents/Research/R files/SAN.txt",header=T)
TC<-read.table("~/Documents/Research/R files/TC.txt",header=T)
accumCC<-specaccum(CC, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
accumSAN<-specaccum(SAN, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
accumTC<-specaccum(TC, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
tiff("sp_accum.tiff")
## S3 method for class 'specaccum':
plot(accumCC, col="red", ci=F,xlab="Samples", ylab="Accumulated OTUs",xlim=c(0, 115), ylim=c(0,15), lty = 1, lwd = 2)
plot(accumSAN, add=T, col="black", ci=F, lty = 2, lwd = 2)
plot(accumTC, add=T, col="blue", ci=F, lty = 4, lwd = 2)
legend.accumtis <- c("CC","SAN","TC")
legend("topleft", title= "Sites Sampled", legend.accumtis, col = c("black","blue","red" ), lty = c(2,4,1), lwd = 2, inset=0.01, cex = 0.8)
dev.off()
CC<-read.table("~/Documents/Research/R files/CC.txt",header=T)
SAN<-read.table("~/Documents/Research/R files/SAN.txt",header=T)
TC<-read.table("~/Documents/Research/R files/TC.txt",header=T)
accumCC<-specaccum(CC, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
accumSAN<-specaccum(SAN, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
accumTC<-specaccum(TC, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
tiff("sp_accum.tiff", res = 300)
## S3 method for class 'specaccum':
plot(accumCC, col="red", ci=F,xlab="Samples", ylab="Accumulated OTUs",xlim=c(0, 115), ylim=c(0,15), lty = 1, lwd = 2)
CC<-read.table("~/Documents/Research/R files/CC.txt",header=T)
SAN<-read.table("~/Documents/Research/R files/SAN.txt",header=T)
TC<-read.table("~/Documents/Research/R files/TC.txt",header=T)
accumCC<-specaccum(CC, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
accumSAN<-specaccum(SAN, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
accumTC<-specaccum(TC, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
tiff("sp_accum.tiff", length = 3, width = 3, units = "in", res = 300)
CC<-read.table("~/Documents/Research/R files/CC.txt",header=T)
SAN<-read.table("~/Documents/Research/R files/SAN.txt",header=T)
TC<-read.table("~/Documents/Research/R files/TC.txt",header=T)
accumCC<-specaccum(CC, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
accumSAN<-specaccum(SAN, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
accumTC<-specaccum(TC, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
tiff("sp_accum.tiff", height = 3, width = 3, units = "in", res = 300)
## S3 method for class 'specaccum':
plot(accumCC, col="red", ci=F,xlab="Samples", ylab="Accumulated OTUs",xlim=c(0, 115), ylim=c(0,15), lty = 1, lwd = 2)
plot(accumSAN, add=T, col="black", ci=F, lty = 2, lwd = 2)
plot(accumTC, add=T, col="blue", ci=F, lty = 4, lwd = 2)
legend.accumtis <- c("CC","SAN","TC")
legend("topleft", title= "Sites Sampled", legend.accumtis, col = c("black","blue","red" ), lty = c(2,4,1), lwd = 2, inset=0.01, cex = 0.8)
dev.off()
CC<-read.table("~/Documents/Research/R files/CC.txt",header=T)
SAN<-read.table("~/Documents/Research/R files/SAN.txt",header=T)
TC<-read.table("~/Documents/Research/R files/TC.txt",header=T)
accumCC<-specaccum(CC, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
accumSAN<-specaccum(SAN, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
accumTC<-specaccum(TC, method = "exact", permutations = 100, conditioned =TRUE, gamma = "jack1")
tiff("sp_accum.tiff", height = 6, width = 6, units = "in", res = 300)
## S3 method for class 'specaccum':
plot(accumCC, col="red", ci=F,xlab="Samples", ylab="Accumulated OTUs",xlim=c(0, 115), ylim=c(0,15), lty = 1, lwd = 2)
plot(accumSAN, add=T, col="black", ci=F, lty = 2, lwd = 2)
plot(accumTC, add=T, col="blue", ci=F, lty = 4, lwd = 2)
legend.accumtis <- c("CC","SAN","TC")
legend("topleft", title= "Sites Sampled", legend.accumtis, col = c("black","blue","red" ), lty = c(2,4,1), lwd = 2, inset=0.01, cex = 0.8)
dev.off()
clrs <- c(CC = "black", TC = "red")
pchs <- c(CC = 15, TC = 17)
tiff("sup_fig3", height = 6, width = 6, units = "in", res = 300)
quartz.options(height=5, width=5)
plot.new()
par(oma = c(1, 1, 1, 1))
par(mar = c( 5, 5, 0, 0 ))
plot.window(xlim = c(min(NMDS1_ling)-1,max(NMDS1_ling)+1), ylim = c(min(NMDS2_ling)-1,max(NMDS2_ling)+1))
axis(side = 1)
axis(side = 2, las = 1)
points(x = NMDS_scores_ling$NMDS1, y = NMDS_scores_ling$NMDS2, pch = pchs[as.character(lingdata$Site)],
col = clrs[as.character(lingdata$Site)], cex = 1)
mtext(side = 1, line = 2, text = "NMDS1")
mtext(side = 2, line = 3, text = "NMDS2" )
legend_text <- c("CC", "TC")
legend("bottomright", title= "Sites Sampled", legend_text, pch = c(15,17),
col = c("black","red"))
box()
dev.off()
clrs <- c(CC = "black", SAN = "blue", TC = "red")
pchs <- c(CC = 21, SAN = 23, TC = 24)
bgs <- c(Seed = "black", Seedling = "white")
tiff("sup_fig2", height = 6, width = 6, units = "in", res = 300)
quartz.options(height=5, width=5)
plot.new()
par(oma = c(1, 1, 1, 1))
par(mar = c( 5, 5, 0, 0 ))
plot.window(xlim = c(min(NMDS1_all)-3,max(NMDS1_all)+1), ylim = c(min(NMDS2_all)-1,max(NMDS2_all)+1))
axis(side = 1)
axis(side = 2, las = 1)
points(x = NMDS1_all, y = NMDS2_all, pch = pchs[as.character(alldata$Site)],
col = alpha("black", alpha = 0.5), bg = alpha(bgs[as.character(alldata$Type)], alpha = 0.5), cex = 1)
mtext(side = 1, line = 2, text = "NMDS1")
mtext(side = 2, line = 3, text = "NMDS2" )
#ordiellipse(NMDSling, lingdata$Site == "CC", show.groups = TRUE, kind = "sd", col = "black", lty = 1, lwd = 2.0)
#ordiellipse(NMDSling, lingdata$Site == "TC", show.groups = TRUE, kind = "sd", col = "red", lty = 1, lwd = 2.0)
legend_text <- c("CC", "SAN", "TC")
legend("bottomleft", title= "Sites Sampled", legend_text, pch = c(21,23,24),col = "black", bty = "n", cex = 0.8)
legend_text2 <- c("Seed", "Seedling")
legend("topleft", title= "Sample Type", legend_text2, pch = 22 ,col = "black", pt.bg = alpha(c("black", "white"), alpha = 0.5), bty = "n", cex = 0.8)
box()
dev.off()
clrs <- c(CC = "black", TC = "red")
pchs <- c(CC = 15, TC = 17)
tiff("sup_fig3.tiff", height = 6, width = 6, units = "in", res = 300)
quartz.options(height=5, width=5)
plot.new()
par(oma = c(1, 1, 1, 1))
par(mar = c( 5, 5, 0, 0 ))
plot.window(xlim = c(min(NMDS1_ling)-1,max(NMDS1_ling)+1), ylim = c(min(NMDS2_ling)-1,max(NMDS2_ling)+1))
axis(side = 1)
axis(side = 2, las = 1)
points(x = NMDS_scores_ling$NMDS1, y = NMDS_scores_ling$NMDS2, pch = pchs[as.character(lingdata$Site)],
col = clrs[as.character(lingdata$Site)], cex = 1)
mtext(side = 1, line = 2, text = "NMDS1")
mtext(side = 2, line = 3, text = "NMDS2" )
legend_text <- c("CC", "TC")
legend("bottomright", title= "Sites Sampled", legend_text, pch = c(15,17),
col = c("black","red"))
box()
dev.off()
clrs <- c(CC = "black", SAN = "blue", TC = "red")
pchs <- c(CC = 21, SAN = 23, TC = 24)
bgs <- c(Seed = "black", Seedling = "white")
tiff("sup_fig2.tiff", height = 6, width = 6, units = "in", res = 300)
quartz.options(height=5, width=5)
plot.new()
par(oma = c(1, 1, 1, 1))
par(mar = c( 5, 5, 0, 0 ))
plot.window(xlim = c(min(NMDS1_all)-3,max(NMDS1_all)+1), ylim = c(min(NMDS2_all)-1,max(NMDS2_all)+1))
axis(side = 1)
axis(side = 2, las = 1)
points(x = NMDS1_all, y = NMDS2_all, pch = pchs[as.character(alldata$Site)],
col = alpha("black", alpha = 0.5), bg = alpha(bgs[as.character(alldata$Type)], alpha = 0.5), cex = 1)
mtext(side = 1, line = 2, text = "NMDS1")
mtext(side = 2, line = 3, text = "NMDS2" )
#ordiellipse(NMDSling, lingdata$Site == "CC", show.groups = TRUE, kind = "sd", col = "black", lty = 1, lwd = 2.0)
#ordiellipse(NMDSling, lingdata$Site == "TC", show.groups = TRUE, kind = "sd", col = "red", lty = 1, lwd = 2.0)
legend_text <- c("CC", "SAN", "TC")
legend("bottomleft", title= "Sites Sampled", legend_text, pch = c(21,23,24),col = "black", bty = "n", cex = 0.8)
legend_text2 <- c("Seed", "Seedling")
legend("topleft", title= "Sample Type", legend_text2, pch = 22 ,col = "black", pt.bg = alpha(c("black", "white"), alpha = 0.5), bty = "n", cex = 0.8)
box()
dev.off()
Input =(
"OTU  Germ  no.germ
Yes   81    143
No    103   410
")
GermrateALL = as.matrix(read.table(textConnection(Input),
header=TRUE,
row.names=1))
fisher.test(GermrateALL)
Input =(
"OTU  Germ  no.germ
Yes   81    143
No    103   413
")
GermrateALL = as.matrix(read.table(textConnection(Input),
header=TRUE,
row.names=1))
fisher.test(GermrateALL)
View(GermrateALL)
fish <- fisher.test(GermrateALL)
summary(fish)
fish
site<-as.factor(seeddata$Site)
library(vegan); library(scales); library(nortest)
seeddata<-read.table("~/Documents/Research/R files/seed_dat.txt",header=T)
seedord<-read.table("~/Documents/Research/R files/seed_ord.txt",header=T)
site<-as.factor(seeddata$Site)
permseed = adonis(seedord ~ site); permseed
set.seed(19841226)
NMDS <- metaMDS(wisconsin(seedord), try = 20, trymax = 50, k=2)
NMDS_scores <- scores(NMDS)
NMDS1 <- NMDS_scores[ ,1]
NMDS2 <- NMDS_scores[ ,2]
NMDS_scores <- as.data.frame(NMDS_scores)
clrs <- c(CC = "black", SAN = "blue", TC = "red")
pchs <- c(CC = 15, SAN = 16, TC = 17)
tiff("sup_NMDS.tiff", height = 5, width = 5, units = "in", res = 200)
quartz.options(height=5, width=5)
plot.new()
par(oma = c(1, 1, 1, 1))
par(mar = c( 5, 5, 0, 0 ))
plot.window(xlim = c(min(NMDS1)-1,max(NMDS1)+1), ylim = c(min(NMDS2)-1,max(NMDS2)+1))
axis(side = 1)
axis(side = 2, las = 1)
points(x = NMDS_scores$NMDS1, y = NMDS_scores$NMDS2, pch = pchs[as.character(seeddata$Site)],
col = clrs[as.character(seeddata$Site)], cex = 1)
mtext(side = 1, line = 2, text = "NMDS1")
mtext(side = 2, line = 3, text = "NMDS2" )
legend_text <- c("CC", "SAN", "TC")
legend("bottomright", title= "Sites Sampled", legend_text, pch = c(15,16,17), col = c("black", "blue", "red"), cex = 0.8)
box()
dev.off()
NMDS$stress
source('~/Documents/Research/USGS/Plant_and_Soil/map_pl_soil.R')
ggplot() +
geom_polygon(data = na, aes(x = long, y= lat, group = group), fill = "gray", color = "black")+
coord_fixed(1.3)
quartz.options(height=6 , width = 6)
plot.new()
par(oma = c(0, 0, 0, 0))
par(mar = c(0,0,0,0))
map(database = "state",
xlim = c(-87, -82), ylim = c(41.3, 44.3), col = "gray90", fill = T)
points(x = sites$lon, y = sites$lat, pch = 20, col = "black")
text(sites$lon[1], sites$lat[1], "SAN", cex = 1, adj = 0, pos = 2)
text(sites$lon[2], sites$lat[2], "CC", cex = 1, pos = 4)
text(sites$lon[3], sites$lat[3], "TC", cex = 1, adj = 0, pos = 2)
text(x = -85, y = 43, "Michigan", cex = 0.7, pos = 4)
text(x = -84, y = 41.5, "Ohio", cex = 0.7, pos = 1)
text(x = -86, y = 41.5, "Indiana", cex = 0.7, pos = 1)
box()
install.packages("Plotrix")
setwd("~/git_repos/Root_ITS/data")
knitr::opts_chunk$set(echo = F)
library(permute); library(vegan); library("dplyr"); library(knitr)
source("data_setup.R")
mean(metadata$n_seqs)
rarefy <- read.table(file = "data/Bickford.groups.rarefaction", header=T, stringsAsFactors=F)
View(rarefy)
ave_columns <- grep(pattern = "X1", colnames(rarefy))
ave_rarefy <- rarefy[ , ave_columns]
View(ave_rarefy)
alpha <- read.table(file = "data/Bickford.groups.ave-std.summary", header=T)
View(alpha)
source('data_setup.R')
setwd("~/git_repos/Root_ITS/code")
source('data_setup.R')
setwd("~/git_repos/Root_ITS/data")
pca <- read.table(file="data/Bickford.subsample.1.pca.axes", header=T)
View(pca)
taxonomy <- read.table(file = "data/Bickford.cons.taxonomy", header=T, stringsAsFactors = F)
View(taxonomy)
taxnocon <- gsub(pattern = "\\(\\d*\\)", replacement = "", x=taxonomy$Taxonomy)
setwd("~/git_repos/Root_ms")
source('~/git_repos/Root_ms/root_col16.R')
percol_nova <- aov(t_percol16$percol ~ t_percol16$Site * t_percol16$Lineage)
summary(percol_nova)
percol_cl_nova <- aov(t_percol16$out_clear ~ t_percol16$Site * t_percol16$Lineage)
summary(percol_cl_nova)
